# 安全

### 创建普通用户

```shell
openssl genrsa -out john.key 2048
openssl req -new -key john.key -out john.csr

cat john.csr | base64 | tr -d "\n"
```


```shell
cat <<EOF | kubectl apply -f -
apiVersion: certificates.k8s.io/v1
kind: CertificateSigningRequest
metadata:
  name: john
spec:
  groups:
  - system:authenticated
  request: LS0tLS1CRUdJTiBDRVJUSUZJQ0FURSBSRVFVRVNULS0tLS0KTUlJQ2lqQ0NBWElDQVFBd1JURUxNQWtHQTFVRUJoTUNRVlV4RXpBUkJnTlZCQWdNQ2xOdmJXVXRVM1JoZEdVeApJVEFmQmdOVkJBb01HRWx1ZEdWeWJtVjBJRmRwWkdkcGRITWdVSFI1SUV4MFpEQ0NBU0l3RFFZSktvWklodmNOCkFRRUJCUUFEZ2dFUEFEQ0NBUW9DZ2dFQkFLckhUcEhxdzBJYmhoNWp6RmZTSmhUN2FTSHZJazNYTXpZMmRKbHoKOUJ3M2FlVFovQUJ3c3dUaXgrcFN0SDFhWHJROHZ5citCMmVubG1hNmJlc0IxNXFGOTkrQ0Y1YTVORkxrR2hiZApSSThGdXFUK3pyQzdvNWZ2V0g5eFpCQ2FiYUthU0pkRzJuU1JLcUY3VmJpZGVmUGhFWC91UTJVMXgzMUNPS05XCnVURFFFVjBqME04Z0t2Z3YzdXlwUW41eWtvbWF5VVdMTGNrWUZncC94Ukk2V2dDYjFDSEdzS2ozUXRkQXdhTUsKcEZCRXRzS1ZucEx1K3B3V1NXbFk1V3VjTFR5T2hPYWdwQ3BOWGNLbDdsUTNkOGcxbks5TXM5THlRTWhzbHFhdAp6Q0tHVm5jK0RsemdxVHIvUURIbXVPaHVkNTdFM2ZpNTdxeDU4elh5aWNQTU8rOENBd0VBQWFBQU1BMEdDU3FHClNJYjNEUUVCQ3dVQUE0SUJBUUNtV24yRk96YU9JYWNuYUx0TU16emMyTmlFWStONVRDUmVaMlBydjczczZuUVIKUDgxcnh3MjNYMWl0WW9OSlNTV2ZyRzRKVXh0RlRKdTlYRnFWY3A4NmJZallNeE15UlNBWU82bVlCK3l6WER1YwpTQWFSZzRxbXBWdUd2OEJiNFVSeWhuSFVTZ1VyRHo2b1RlaHF4MFBxSXovMUNaa2FRVk5XMVNRZTdiU2JIWTVWCnZYc2xEN3ZPanB6Y1dEZHZzY3lqVTE1UTdZRDZqWFdWNUEvdGFWQXlMRmVKcVVOeGY0U29XbTc1R29CVDl3NmwKbDAwdkxySFJCRkpGZmdFditiOUpqSTRZaEpyN1pFdjVpTTd5cVBaVE9nOVBKL2pCZ3l1cTZXOE5vS0lKOGx4TAo5cjdjUmJCYTZHMitZUGJqdEpYeFp3cHkvaHJyQ2pEQzJOR25xRGE0Ci0tLS0tRU5EIENFUlRJRklDQVRFIFJFUVVFU1QtLS0tLQo=
  signerName: kubernetes.io/kube-apiserver-client
  usages:
  - client auth
EOF
```

```shell
kubectl get csr
kubectl certificate approve john
```

```shell
kubectl get csr john  -o jsonpath='{.status.certificate}' > john.crt
```

```shell
kubectl create role developer --verb=create --verb=get --verb=list --verb=update --verb=delete --resource=pods
```

```shell
kubectl create rolebinding developer-binding-john --role=developer --user=john
```

```shell

```

